---
import { getCollection, render } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { stringToDate } from "../../lib/stringToDate";

export const prerender = true;

export async function getStaticPaths() {
  const posts = await getCollection("blog");

  return posts.map((post) => ({
    params: { id: post.id.replace(/\.md$/, "") },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);

const parsedDate = stringToDate(post.data.date).toLocaleDateString("es-MX", {
  day: "2-digit",
  month: "long",
  year: "numeric",
});
---

<Layout>
  <div class="max-w-screen-lg px-4 pt-12 pb-20 mx-auto">
    <h1>{post.data.title}</h1>

    <time datetime={parsedDate}>{parsedDate}</time> - <span>Luis Cervantes</span
    >

    <hr />

    <main class="content-container">
      <Content />
    </main>

    <!-- TODO: Add related articles -->
  </div>
</Layout>
